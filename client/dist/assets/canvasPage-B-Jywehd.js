import{r as a,j as t,g as W,d as K,t as Y,o as G,R as H,n as J,m as X,C as q,M,u as O,v as I}from"./index-CrwugIwe.js";import{r as _,a as V,c as k,s as $,o as F,b as ee,g as te,e as oe,f as ne,i as N,h as se,j as re}from"./firebase-Cim4QoNG.js";/* empty css                  */const ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAA4NJREFUeF7tnE1u1EAQRqstOACTweOcAAkWHAAWsAGFIwAnABHOQhCcADgCEWxgAQdgARInyNiZDAcIciGHjATDYmpcXa5u82Vdf37P7bFbSgfCnyuB4NodzQkCnG8CCIAAZwLO7bECIMCZgHN7rID/XcBRs9wL1O4FCleY+DpRmDkzWWvPdaDwhYm/MxWHu+XkMOZ8ritgXi9eUQgPYl6QeS3m19Vs+jBWHzcB8+aEY12ER52q3InCLkqRbQE0zY/9ltpn2+alFF9Q8bQsLx1oZxpcQL1c3uCf/Ek7eAr54UK4OZtMPmtmGVzAUb14EUJ4pBk6lVxmfrk7mz7WzDO4gHmz/EDEtzRDp5MbPlbl5LZmnuEF1IuGQrisGTqZXObjajYtNfMML2DD20+stwsNlD9zN72taeeFgA2mICDWrdyzDgT0BBcrDQJikexZBwJ6gouVBgGxSPasAwE9wcVKS06AdiBtfiyw0jrW8279HaAdSJsvBRcrznpeCMjtQ0x7R2jzY93Z0jrW82IFYAX8TUC7uSW9s6VxWAFSUkZxEGAEVloWAqSkjOIgwAistCwESEkZxUGAEVhpWQiQkjKKgwAjsNKyECAlZRQHAUZgpWUhQErKKA4CjMBKy0KAlJRRHAQYgZWWhQApKaM4CDACKy0LAVJSRnEQYARWWhYCpKSM4iDACKy0LARISRnFQYARWGlZCJCSMoqDACOw0rIQICVlFAcBRmClZSFASsooDgKMwErLQoCUlFEcBBiBlZaFACkpozgIMAIrLQsBUlJGcRBgBFZadoQCFvP0zgaV6liP47oqp1Xf7C5v8H/Sq5uTd0x0RzN0KrmB6P2s3LmrmWdwAfNmcUAUnmiGTieXn1fldF8zz+ACfh9VzG81Q6eSyxTuaY8yHlxABy/LI4v/efzHOcLYRcCZBBxdfKbUTUDXPMcjjGMdWbxaUK4CuiG6o4zb0/Z+CMVV4vZacmeKMh9TKL4yt9+Ki8Ub7VHF608ydwGp/KB6zQEBXuTP+0IABDgTcG6PFQABzgSc22MFQIAzAef2PVbAmPbzibyPSNtawJj287ubPzsB49rPz1DAmPbzs1wBo9nPP//xze4RtHppyH0/f3Ud2QrIdT9//a0zawFZ7OdveM/PXoDzd0z27bf+Dsj+ihO7AAhwFgIBEOBMwLk9VgAEOBNwbo8V4CzgF/1TBI4lFoAgAAAAAElFTkSuQmCC";function ie(){const C=a.useRef(null),A=a.useRef(null),v=a.useRef(null),D=a.useRef(null),x=a.useRef(null),w=a.useRef(null),y=_(),B={video:!0,audio:!0},L={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10},r=new RTCPeerConnection(L);a.useEffect(()=>()=>{R()},[]);async function E(){try{const o=await navigator.mediaDevices.getUserMedia(B);x.current=o,o.getTracks().forEach(i=>r.addTrack(i,o)),r.ontrack=i=>{const d=i.streams[0];w.current=d,A.current&&(A.current.srcObject=d)},C.current.srcObject=o}catch(o){console.error("Error starting streaming:",o)}}async function R(){const o=x.current,i=w.current;r&&r.close(),o&&(o.getTracks().forEach(d=>d.stop()),x.current=null),i&&(i.getTracks().forEach(d=>d.stop()),w.current=null)}async function S(){try{await E();const o=await V(k(y,"calls"),{}),i=k(o,"answerCandidates"),d=o.id;v.current.textContent=d,r.onicecandidate=async l=>{l.candidate&&await V(k(o,"offerCandidates"),l.candidate.toJSON())};const m=await r.createOffer();await r.setLocalDescription(m);const p={sdp:m.sdp,type:m.type};await $(o,{offer:p});const h=F(o,l=>{const f=l.data();if(!r.currentRemoteDescription&&(f!=null&&f.answer)){const g=new RTCSessionDescription(f.answer);r.setRemoteDescription(g)}}),u=F(i,l=>{l.docChanges().forEach(f=>{if(f.type==="added"){const g=new RTCIceCandidate(f.doc.data());r.addIceCandidate(g)}})})}catch(o){console.error("Error creating offer:",o)}}async function b(){try{await E();const o=D.current.value,i=ee(y,"calls",o);console.log(r);const d=k(i,"answerCandidates");r.onicecandidate=async g=>{g.candidate&&await V(k(i,"answerCandidates"),g.candidate.toJSON())};const m=await te(i);console.log(m.data());const p=m.data().offer;await r.setRemoteDescription(new RTCSessionDescription(p));const h=await r.createAnswer();await r.setLocalDescription(h);const u={type:h.type,sdp:h.sdp};await oe(i,{answer:u});const l=k(i,"offerCandidates"),f=F(l,g=>{g.docChanges().forEach(P=>{if(P.type==="added"){const e=new RTCIceCandidate(P.doc.data());r.addIceCandidate(e)}})})}catch(o){console.error("Error answering call:",o)}}function j(){const o=v.current.textContent;navigator.clipboard.writeText(o)}return t.jsxs("div",{id:"videosDiv",children:[t.jsx("h2",{className:"mediumTitle",children:" My Video"}),t.jsx("video",{id:"myVideo",ref:C,autoPlay:!0}),t.jsx("div",{id:"controlsDiv",children:t.jsxs("div",{class:"horizontalDiv",children:[t.jsx(W,{id:"startCallButton",onClick:S,children:"Start Call"}),t.jsx(W,{id:"endCallButton",onClick:R,children:"End Call"})]})}),t.jsxs("div",{class:"horizontalDiv",children:[t.jsx(K,{id:"videoDivHeader",children:" Meeting Code : "}),t.jsx("p",{id:"callCode",type:"text",ref:v}),t.jsx("img",{id:"copyCode",src:ce,onClick:j})]}),t.jsx("h2",{className:"mediumTitle",children:" Other Video"}),t.jsx("video",{id:"remoteVideo",ref:A,autoPlay:!0}),t.jsxs("div",{class:"horizontalDiv",children:[t.jsx("input",{id:"callText",ref:D,type:"text",placeholder:"Enter Meeting Code To Join"}),t.jsx(W,{id:"joinCallButton",onClick:b,children:"Join Call"})]})]})}const T=JSON.parse(sessionStorage.getItem("currentCourseData"));function ae(){const C=a.useRef(null),A=a.useRef(null),v=a.useRef(null),D=a.useRef(null),x=a.useRef(null),w=a.useRef(null),y=a.useRef(null);let B=!0,L=[],r=[],E=!1,R=!1,S=!1,b=!1,j=0,o=0;a.useEffect(()=>{const e=C.current;if(e){const s=e.getContext("2d");return y.current=s,e.addEventListener("mousedown",p),e.addEventListener("mousemove",h),e.addEventListener("mouseup",u),e.addEventListener("mouseout",u),e.addEventListener("touchstart",p),e.addEventListener("touchmove",h),e.addEventListener("touchend",u),e.addEventListener("touchcancel",u),()=>{e.removeEventListener("mousedown",p),e.removeEventListener("mousemove",h),e.removeEventListener("mouseup",u),e.removeEventListener("mouseout",u),e.removeEventListener("touchstart",p),e.removeEventListener("touchmove",h),e.removeEventListener("touchend",u),e.removeEventListener("touchcancel",u)}}},[]);function i(){console.log(T.courseName);const e=N(T.courseName);se(e,s=>{const n=s.val();n?(r=Object.values(n),B==!0&&g()):console.log("No data found")})}function d(){console.log(T.courseName);const e=N(T.courseName);re(e).then(s=>{const n=s.val();r=Object.values(n),g()})}const m=e=>{let s,n;const c=C.current;if(e.touches&&e.touches.length>0){const z=e.changedTouches[0],Q=c.getBoundingClientRect(),U=c.width/Q.width,Z=c.height/Q.height;s=U*(z.clientX-Q.left),n=Z*(z.clientY-Q.top)}else s=e.offsetX,n=e.offsetY;return{x:s,y:n}},p=e=>{const{x:s,y:n}=m(e);E=!0,[j,o]=[s,n]},h=e=>{if(!E)return;const{x:s,y:n}=m(e),c=y.current;R?(c.strokeStyle="white",c.lineWidth=eraserSlider.value):S?(c.strokeStyle=colourPicker.value,c.lineWidth=brushSlider.value,c.lineJoin="round",c.lineCap="round"):b&&(c.strokeStyle=colourPicker.value,c.lineWidth=penSlider.value,c.lineCap="square",c.lineJoin="miter"),c.beginPath(),c.moveTo(j,o),c.lineTo(s,n),c.stroke();const z={x1:j,y1:o,x2:s,y2:n,color:c.strokeStyle,lineWidth:c.lineWidth};L.push(z),ne(z,T.courseName),[j,o]=[s,n]},u=()=>{E=!1},l=e=>{A.current.style.backgroundColor="",v.current.style.backgroundColor="",D.current.style.backgroundColor="",console.log(T),e==="eraser"?(A.current.style.backgroundColor="#ffcc00",R=!0,b=!1,S=!1):e==="pen"?(v.current.style.backgroundColor="#ffcc00",R=!1,b=!0,S=!1):e==="brush"&&(D.current.style.backgroundColor="#ffcc00",R=!1,b=!1,S=!0)},f=e=>{x.current.style.backgroundColor="",w.current.style.backgroundColor="",e==="enabled"?(B=!0,x.current.style.backgroundColor="#ffcc00",d()):e==="disabled"&&(B=!1,w.current.style.backgroundColor="#ffcc00",P())};function g(){const e=y.current,s=C.current;e.clearRect(0,0,s.width,s.height),r.forEach(n=>{e.strokeStyle=n.color,e.lineWidth=n.lineWidth,e.beginPath(),e.moveTo(n.x1,n.y1),e.lineTo(n.x2,n.y2),e.stroke()})}function P(){const e=y.current,s=C.current;e.clearRect(0,0,s.width,s.height),L.forEach(n=>{e.strokeStyle=n.color,e.lineWidth=n.lineWidth,e.beginPath(),e.moveTo(n.x1,n.y1),e.lineTo(n.x2,n.y2),e.stroke()})}return G(),i(),t.jsxs(H.StrictMode,{children:[t.jsx(J,{imgSrc:X}),t.jsxs("div",{id:"body",children:[t.jsxs("div",{id:"toolSection",children:[t.jsx(q,{text:"Colour Picker",id:"colourPicker"}),t.jsx(M,{children:"Adjust Tool Size"}),t.jsx(O,{imgSrc:"https://img.icons8.com/ios/50/pencil--v1.png",id:"penSlider"}),t.jsx(O,{imgSrc:"https://img.icons8.com/ios-filled/50/paint-brush.png",id:"brushSlider"}),t.jsx(O,{imgSrc:"https://img.icons8.com/ios-filled/50/erase.png",id:"eraserSlider"}),t.jsx(M,{children:"Choose Tool"}),t.jsxs("div",{className:"buttonsDiv",children:[t.jsx(I,{onClick:()=>l("pen"),ref:v,id:"pen",imgSrc:"https://img.icons8.com/ios/50/pencil--v1.png"}),t.jsx(I,{onClick:()=>l("brush"),ref:D,id:"brush",imgSrc:"https://img.icons8.com/ios-filled/50/paint-brush.png"}),t.jsx(I,{onClick:()=>l("eraser"),ref:A,id:"eraser",imgSrc:"https://img.icons8.com/ios-filled/50/erase.png"})]}),t.jsx(M,{children:"View Others Strokes"}),t.jsxs("div",{className:"buttonsDiv",children:[t.jsx(I,{onClick:()=>f("enabled"),ref:x,id:"viewEnbld",imgSrc:"https://img.icons8.com/ios-glyphs/30/hide.png"}),t.jsx(I,{onClick:()=>f("disabled"),ref:w,id:"viewDsbld",imgSrc:"https://img.icons8.com/material-sharp/24/visible.png"})]})]}),t.jsx("canvas",{ref:C,id:"Canvas",width:"900",height:"450"}),t.jsx(ie,{children:" "})]})]})}Y.render(t.jsx(ae,{}),document.getElementById("root"));
